{"ast":null,"code":"import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _regeneratorRuntime from\"C:/Users/hogwa/Documents/AdvancedNodeAuth/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/hogwa/Documents/AdvancedNodeAuth/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/hogwa/Documents/AdvancedNodeAuth/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from\"react\";import axios from\"axios\";import\"./PrivateScreen.css\";import{BrowserRouter as Router,Route}from\"react-router-dom\";import QuizApp from\"../quizapp/QuizApp\";var PrivateScreen=function PrivateScreen(_ref){var history=_ref.history;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),privateData=_useState4[0],setPrivateData=_useState4[1];useEffect(function(){if(!localStorage.getItem(\"authToken\")){history.push(\"/login\");}var fetchPrivateDate=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var config,_yield$axios$get,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:config={headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \".concat(localStorage.getItem(\"authToken\"))}};_context.prev=1;_context.next=4;return axios.get(\"/api/private\",config);case 4:_yield$axios$get=_context.sent;data=_yield$axios$get.data;setPrivateData(data.data);_context.next=13;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](1);localStorage.removeItem(\"authToken\");setError(\"You are not authorized please login\");case 13:case\"end\":return _context.stop();}}},_callee,null,[[1,9]]);}));return function fetchPrivateDate(){return _ref2.apply(this,arguments);};}();fetchPrivateDate();},[history]);var logoutHandler=function logoutHandler(){localStorage.removeItem(\"authToken\");history.push(\"/login\");};return error?/*#__PURE__*/_jsx(\"span\",{className:\"error-message\",children:error}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",component:QuizApp})}),/*#__PURE__*/_jsx(\"button\",{onClick:logoutHandler,children:\"Logout\"})]})});};export default PrivateScreen;","map":{"version":3,"sources":["C:/Users/hogwa/documents/advancednodeauth/client/src/components/screens/PrivateScreen.js"],"names":["useState","useEffect","axios","BrowserRouter","Router","Route","QuizApp","PrivateScreen","history","error","setError","privateData","setPrivateData","localStorage","getItem","push","fetchPrivateDate","config","headers","Authorization","get","data","removeItem","logoutHandler"],"mappings":"+nBAAA,OAASA,QAAT,CAAmBC,SAAnB,KAAoC,OAApC,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAO,qBAAP,CACA,OAASC,aAAa,GAAIC,CAAAA,MAA1B,CAAmCC,KAAnC,KAAgD,kBAAhD,CACA,MAAOC,CAAAA,OAAP,KAAoB,oBAApB,CAEA,GAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,MAAiB,IAAdC,CAAAA,OAAc,MAAdA,OAAc,eACXR,QAAQ,CAAC,EAAD,CADG,wCAC9BS,KAD8B,eACvBC,QADuB,8BAECV,QAAQ,CAAC,EAAD,CAFT,yCAE9BW,WAF8B,eAEjBC,cAFiB,eAIrCX,SAAS,CAAC,UAAM,CACd,GAAG,CAACY,YAAY,CAACC,OAAb,CAAqB,WAArB,CAAJ,CAAuC,CACrCN,OAAO,CAACO,IAAR,CAAa,QAAb,EACD,CAED,GAAMC,CAAAA,gBAAgB,2FAAG,oKACjBC,MADiB,CACR,CACbC,OAAO,CAAE,CACP,eAAgB,kBADT,CAEPC,aAAa,kBAAYN,YAAY,CAACC,OAAb,CAAqB,WAArB,CAAZ,CAFN,CADI,CADQ,uCASEZ,CAAAA,KAAK,CAACkB,GAAN,CAAU,cAAV,CAA0BH,MAA1B,CATF,uCASbI,IATa,kBASbA,IATa,CAUrBT,cAAc,CAACS,IAAI,CAACA,IAAN,CAAd,CAVqB,+EAYrBR,YAAY,CAACS,UAAb,CAAwB,WAAxB,EACAZ,QAAQ,CAAC,qCAAD,CAAR,CAbqB,oEAAH,kBAAhBM,CAAAA,gBAAgB,2CAAtB,CAiBAA,gBAAgB,GACjB,CAvBQ,CAuBN,CAACR,OAAD,CAvBM,CAAT,CAyBA,GAAMe,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CAC1BV,YAAY,CAACS,UAAb,CAAwB,WAAxB,EACAd,OAAO,CAACO,IAAR,CAAa,QAAb,EACD,CAHD,CAKA,MAAON,CAAAA,KAAK,cACV,aAAM,SAAS,CAAC,eAAhB,UAAiCA,KAAjC,EADU,cAGV,sCACE,oCACA,KAAC,MAAD,wBACE,KAAC,KAAD,EAAO,KAAK,KAAZ,CAAa,IAAI,CAAC,GAAlB,CAAsB,SAAS,CAAEH,OAAjC,EADF,EADA,cAIA,eAAQ,OAAO,CAAEiB,aAAjB,oBAJA,GADF,EAHF,CAYD,CA9CD,CAgDA,cAAehB,CAAAA,aAAf","sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport \"./PrivateScreen.css\";\r\nimport { BrowserRouter as Router,  Route } from \"react-router-dom\";\r\nimport QuizApp from \"../quizapp/QuizApp\";\r\n\r\nconst PrivateScreen = ({ history }) => {\r\n  const [error, setError] = useState(\"\");\r\n  const [privateData, setPrivateData] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    if(!localStorage.getItem(\"authToken\")) {\r\n      history.push(\"/login\")\r\n    }\r\n\r\n    const fetchPrivateDate = async () => {\r\n      const config = {\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${localStorage.getItem(\"authToken\")}`,\r\n        },\r\n      };\r\n\r\n      try {\r\n        const { data } = await axios.get(\"/api/private\", config);\r\n        setPrivateData(data.data);\r\n      } catch (error) {\r\n        localStorage.removeItem(\"authToken\");\r\n        setError(\"You are not authorized please login\");\r\n      }\r\n    };\r\n\r\n    fetchPrivateDate();\r\n  }, [history]);\r\n\r\n  const logoutHandler = () => {\r\n    localStorage.removeItem(\"authToken\");\r\n    history.push(\"/login\");\r\n  }\r\n\r\n  return error ? (\r\n    <span className=\"error-message\">{error}</span>\r\n  ) : (\r\n    <>\r\n      <div> \r\n      <Router>\r\n        <Route exact path=\"/\" component={QuizApp} />\r\n      </Router>\r\n      <button onClick={logoutHandler}>Logout</button>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PrivateScreen;\r\n"]},"metadata":{},"sourceType":"module"}